# 本地测试指南

## 🚀 快速开始测试

### 1. 确保服务运行
```bash
# 检查Supabase服务状态
supabase status

# 启动开发服务器（如果没运行）
npm run dev
```

### 2. 访问应用
- 主应用：http://localhost:3000
- 邮件查看器：http://127.0.0.1:54324

## 📧 Magic Link 认证测试

### 发送登录邮件
1. 访问 http://localhost:3000/#/diary
2. 点击登录按钮
3. 输入测试邮箱：`test@example.com`
4. 点击"发送登录链接"

### 查看和使用邮件
1. 打开邮件界面：http://127.0.0.1:54324
2. 在收件箱找到 `test` 用户
3. 点击查看邮件内容
4. 点击邮件中的"登录"链接
5. 系统自动完成认证

## 🐱 完整功能测试流程

### 1. 用户注册/登录
- ✅ Magic Link 邮件发送
- ✅ 邮件接收和查看
- ✅ 登录链接点击
- ✅ 自动用户创建

### 2. 猫咪管理
- ✅ 添加新猫咪档案
- ✅ 上传猫咪头像
- ✅ 编辑猫咪信息
- ✅ 归档/恢复猫咪

### 3. 日记功能
- ✅ 创建新日记
- ✅ 上传日记图片
- ✅ 健康数据记录
- ✅ 隐私设置

### 4. 浏览和交互
- ✅ 查看公开日记时间轴
- ✅ 猫咪档案详情页
- ✅ 日记详情页面
- ✅ 图片画廊功能

## 🛠️ 测试数据准备

### 推荐测试邮箱
```
测试用户1: alice@example.com
测试用户2: bob@test.com  
测试用户3: charlie@demo.org
```

### 测试猫咪数据
```
猫咪1: 小橘 (橘猫, 2岁)
猫咪2: 小黑 (黑猫, 1.5岁)  
猫咪3: 小白 (白猫, 3岁)
```

### 测试日记内容
```
标题: 小橘今天很开心
内容: 今天天气很好，小橘在阳台晒太阳，看起来很享受。
心情: 😸 开心
健康数据: 体重 4.2kg，体温 38.5°C
```

## 🔍 调试和检查

### 查看数据库
```bash
# 打开Supabase Studio（数据库管理界面）
supabase dashboard

# 或直接访问
http://127.0.0.1:54323
```

### 查看日志
```bash
# 查看Supabase服务日志
supabase logs

# 查看API调用
# 在浏览器开发者工具 Network 标签查看
```

### 重置数据
```bash
# 重置本地数据库（清空所有数据）
supabase db reset

# 重启所有服务
supabase restart
```

## 🎯 常见测试场景

### 场景1：新用户完整流程
1. 使用新邮箱注册
2. 查看欢迎邮件
3. 完成首次登录
4. 添加第一只猫咪
5. 写第一篇日记

### 场景2：多猫咪管理
1. 添加3只不同的猫咪
2. 为每只猫咪写日记
3. 测试猫咪档案页面
4. 测试归档功能

### 场景3：隐私和分享
1. 创建私密日记
2. 创建公开日记
3. 测试匿名用户浏览
4. 测试分享功能

### 场景4：图片上传
1. 上传猫咪头像
2. 批量上传日记图片
3. 测试图片查看器
4. 测试图片删除

## ⚠️ 注意事项

### 本地环境限制
- 邮件不会发送到真实邮箱
- 文件存储在本地容器中
- 数据在容器重启后可能丢失

### 生产环境切换
要切换到生产环境：
1. 更新 `.env` 文件使用云端Supabase配置
2. 配置真实SMTP邮件服务
3. 设置生产域名

## 🔗 有用链接

- 本地应用：http://localhost:3000
- 邮件查看：http://127.0.0.1:54324  
- 数据库管理：http://127.0.0.1:54323
- API文档：http://127.0.0.1:54321/rest/v1/