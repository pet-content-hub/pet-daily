import{_ as U,c as D,a as u,e as L,i,b as e,n as V,p as W,r as C,u as H,q as F,o as O,s as P,k as T,w as q,l as j,t as d,F as E,g as J,m as A,j as z}from"./main-CcXaIEdh.js";import{u as G,_ as K}from"./ArticleCard-W4_svnRl.js";const Q={class:"share-options"},X={__name:"ShareMenu",props:{article:{type:Object,required:!0},isVisible:{type:Boolean,default:!1}},emits:["close"],setup($,{emit:f}){const l=$,b=f,y=D(()=>navigator.share!==void 0);function t(){b("close")}function v(){const a=window.location.href,o=l.article.title,g=l.article.excerpt,n=`${o}

${g}

é˜…è¯»å…¨æ–‡ï¼š${a}`;/micromessenger/i.test(navigator.userAgent)&&typeof WeixinJSBridge<"u"?(WeixinJSBridge.invoke("shareTimeline",{title:o,desc:g,link:a,imgUrl:"https://www.mao.com.cn/assets/images/logo.png"}),p("æ­£åœ¨åˆ†äº«åˆ°å¾®ä¿¡...")):navigator.clipboard.writeText(n).then(()=>{p("å¾®ä¿¡åˆ†äº«å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼è¯·åœ¨å¾®ä¿¡ä¸­ç²˜è´´åˆ†äº«ã€‚")}).catch(()=>{p("è¯·æ‰‹åŠ¨å¤åˆ¶é“¾æŽ¥åˆ°å¾®ä¿¡åˆ†äº«")}),t()}function w(){const a=encodeURIComponent(window.location.href),o=encodeURIComponent(l.article.title),g=`https://service.weibo.com/share/share.php?url=${a}&title=${o}`;window.open(g,"_blank"),t()}function k(){navigator.clipboard.writeText(window.location.href).then(()=>{p("é“¾æŽ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼")}).catch(()=>{p("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶")}),t()}function r(){navigator.share&&navigator.share({title:l.article.title,text:l.article.excerpt,url:window.location.href}).catch(a=>{console.log("åˆ†äº«å¤±è´¥:",a),p("åˆ†äº«å¤±è´¥ï¼Œè¯·å°è¯•å…¶ä»–æ–¹å¼")}),t()}function p(a){const o=document.createElement("div");o.className="toast",o.textContent=a,document.body.appendChild(o),setTimeout(()=>{document.body.removeChild(o)},2e3)}return(a,o)=>$.isVisible?(i(),u("div",{key:0,class:"share-menu",onClick:t},[o[6]||(o[6]=e("div",{class:"share-overlay"},null,-1)),e("div",{class:"share-content",onClick:o[0]||(o[0]=V(()=>{},["stop"]))},[e("div",{class:"share-header"},[o[1]||(o[1]=e("h3",null,"åˆ†äº«æ–‡ç« ",-1)),e("button",{class:"close-btn",onClick:t},"Ã—")]),e("div",Q,[e("button",{class:"share-option wechat",onClick:v},o[2]||(o[2]=[e("span",{class:"icon"},"ðŸ’¬",-1),e("span",{class:"label"},"å¾®ä¿¡",-1)])),e("button",{class:"share-option weibo",onClick:w},o[3]||(o[3]=[e("span",{class:"icon"},"ðŸ“±",-1),e("span",{class:"label"},"å¾®åš",-1)])),e("button",{class:"share-option copy",onClick:k},o[4]||(o[4]=[e("span",{class:"icon"},"ðŸ“‹",-1),e("span",{class:"label"},"å¤åˆ¶é“¾æŽ¥",-1)])),y.value?(i(),u("button",{key:0,class:"share-option native",onClick:r},o[5]||(o[5]=[e("span",{class:"icon"},"ðŸ“¤",-1),e("span",{class:"label"},"ç³»ç»Ÿåˆ†äº«",-1)]))):L("",!0)])])])):L("",!0)}},Y=U(X,[["__scopeId","data-v-fb5dbbb5"]]),Z={class:"article-page"},ee={key:0,class:"loading-container"},te={key:1,class:"article-content"},oe={class:"article-header"},se={class:"article-meta"},ne={class:"article-category"},ae={class:"article-info"},le={class:"article-date"},ie={class:"read-time"},re={class:"article-excerpt"},ce={class:"article-icon"},ue={class:"article-body"},de=["innerHTML"],pe={key:1,class:"placeholder-content"},me={class:"article-footer"},ve={class:"article-tags"},ge={class:"tag"},he={class:"article-actions"},fe={key:2,class:"not-found"},ye={key:3,class:"related-articles"},we={class:"related-grid"},_e={__name:"Article",setup($){const f=P(),l=G(),b=W(),y=C(!0),t=C(null),v=C(""),w=C(!1),k=D(()=>t.value?l.articles.filter(n=>n.slug!==t.value.slug&&n.category===t.value.category).slice(0,3):[]),r=D(()=>t.value?{title:t.value.title,description:t.value.excerpt,keywords:`${t.value.category},çŒ«å’ª,å…»çŒ«,å® ç‰©æŠ¤ç†`,ogTitle:`${t.value.title} - çŒ«å’ªä¸–ç•Œ`,ogDescription:t.value.excerpt,ogUrl:`https://www.mao.com.cn/#/stories/${t.value.slug}`}:{title:"æ–‡ç« è¯¦æƒ…",description:"é˜…è¯»ä¸“ä¸šçš„å…»çŒ«çŸ¥è¯†æ–‡ç« "});H(()=>({title:r.value.title,meta:[{name:"description",content:r.value.description},{name:"keywords",content:r.value.keywords},{property:"og:title",content:r.value.ogTitle},{property:"og:description",content:r.value.ogDescription},{property:"og:type",content:"article"},{property:"og:url",content:r.value.ogUrl},{property:"og:image",content:"https://www.mao.com.cn/assets/images/logo.png"},{property:"og:site_name",content:"çŒ«å’ªä¸–ç•Œ"},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:r.value.ogTitle},{name:"twitter:description",content:r.value.ogDescription},{name:"twitter:image",content:"https://www.mao.com.cn/assets/images/logo.png"},{name:"format-detection",content:"telephone=no"},{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"},{itemprop:"name",content:"çŒ«å’ªä¸–ç•Œ - æœ€å…¨å…»çŒ«çŸ¥è¯†"},{itemprop:"image",content:"https://www.mao.com.cn/assets/images/logo.png"}]}));function p(n){return l.formatDate(n)}async function a(n){var s,h,_;y.value=!0;try{l.articles.length===0&&await l.loadArticles();const x=l.getArticleBySlug(n);if(x){t.value=x;try{const m=await fetch(`${b.basePath}/articles/${n}.html`);if(m.ok){const M=await m.text(),c=new DOMParser().parseFromString(M,"text/html"),S=c.querySelector(".article-body")||c.querySelector("main")||c.body;S&&(v.value=S.innerHTML)}}catch{console.log("æ— æ³•åŠ è½½å®Œæ•´æ–‡ç« å†…å®¹ï¼Œä½¿ç”¨æ‘˜è¦")}}else try{const m=await fetch(`${b.basePath}/articles/${n}.html`);if(m.ok){const M=await m.text(),c=new DOMParser().parseFromString(M,"text/html"),S=((s=c.querySelector("h1"))==null?void 0:s.textContent)||"æ–‡ç« è¯¦æƒ…",N=((h=c.querySelector('meta[name="description"]'))==null?void 0:h.content)||"ä¸“ä¸šçš„å…»çŒ«çŸ¥è¯†æ–‡ç« ",R=((_=c.querySelector(".article-category"))==null?void 0:_.textContent)||"å…»çŒ«çŸ¥è¯†";t.value={slug:n,title:S,excerpt:N,category:R,date:new Date().toISOString().split("T")[0],readTime:"5åˆ†é’Ÿ",icon:"ðŸ±"};const B=c.querySelector(".article-body")||c.querySelector("main")||c.body;B&&(v.value=B.innerHTML)}else t.value=null}catch(m){console.log("æ— æ³•åŠ è½½æ–‡ç« :",m),t.value=null}}catch(x){console.error("åŠ è½½æ–‡ç« å¤±è´¥:",x),t.value=null}finally{y.value=!1}}function o(){if(!t.value){alert("æ–‡ç« ä¿¡æ¯æœªåŠ è½½å®Œæˆ");return}w.value=!0}function g(){w.value=!1}return F(()=>f.params.slug,n=>{n&&a(n)},{immediate:!0}),O(()=>{f.params.slug&&a(f.params.slug)}),(n,s)=>{const h=j("RouterLink");return i(),u("div",Z,[y.value?(i(),u("div",ee,s[0]||(s[0]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"åŠ è½½æ–‡ç« ä¸­...",-1)]))):t.value?(i(),u("article",te,[e("header",oe,[e("div",se,[e("span",ne,[T(h,{to:`/categories/${encodeURIComponent(t.value.category)}`},{default:q(()=>[A(d(t.value.category),1)]),_:1},8,["to"])]),e("div",ae,[e("span",le,"ðŸ“… "+d(p(t.value.date)),1),e("span",ie,"â±ï¸ "+d(t.value.readTime),1)])]),e("h1",null,d(t.value.title),1),e("div",re,d(t.value.excerpt),1),e("div",ce,d(t.value.icon||"ðŸ±"),1)]),e("div",ue,[v.value?(i(),u("div",{key:0,innerHTML:v.value},null,8,de)):(i(),u("div",pe,[e("p",null,d(t.value.excerpt),1),e("p",null,"è¿™æ˜¯ä¸€ç¯‡å…³äºŽ"+d(t.value.category)+"çš„ä¸“ä¸šæ–‡ç« ã€‚æˆ‘ä»¬ä¼šæŒç»­ä¸ºæ‚¨æä¾›é«˜è´¨é‡çš„å…»çŒ«çŸ¥è¯†å†…å®¹ã€‚",1),s[1]||(s[1]=e("p",null,"å¦‚æžœæ‚¨å¯¹æ­¤æ–‡ç« æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œæ¬¢è¿Žé€šè¿‡æˆ‘ä»¬çš„è”ç³»æ–¹å¼ä¸Žæˆ‘ä»¬æ²Ÿé€šã€‚",-1))]))]),e("footer",me,[e("div",ve,[e("span",ge,d(t.value.category),1),s[2]||(s[2]=e("span",{class:"tag"},"å…»çŒ«çŸ¥è¯†",-1)),s[3]||(s[3]=e("span",{class:"tag"},"å® ç‰©æŠ¤ç†",-1))]),e("div",he,[e("button",{onClick:o,class:"share-btn"}," ðŸ“¤ åˆ†äº«æ–‡ç«  "),T(h,{to:"/",class:"back-btn"},{default:q(()=>s[4]||(s[4]=[A(" ðŸ  è¿”å›žé¦–é¡µ ",-1)])),_:1,__:[4]})])])])):(i(),u("div",fe,[s[6]||(s[6]=e("h2",null,"æ–‡ç« æœªæ‰¾åˆ°",-1)),s[7]||(s[7]=e("p",null,"æŠ±æ­‰ï¼Œæ‚¨è¦æŸ¥çœ‹çš„æ–‡ç« ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤ã€‚",-1)),T(h,{to:"/",class:"back-btn"},{default:q(()=>s[5]||(s[5]=[A("ðŸ  è¿”å›žé¦–é¡µ",-1)])),_:1,__:[5]})])),k.value.length>0?(i(),u("section",ye,[s[8]||(s[8]=e("h3",null,"ç›¸å…³æ–‡ç« æŽ¨è",-1)),e("div",we,[(i(!0),u(E,null,J(k.value,_=>(i(),z(K,{key:_.slug,article:_},null,8,["article"]))),128))])])):L("",!0),T(Y,{article:t.value,"is-visible":w.value,onClose:g},null,8,["article","is-visible"])])}}},xe=U(_e,[["__scopeId","data-v-feec2019"]]);export{xe as default};
